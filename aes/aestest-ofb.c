static int test_AES128_OFB(void)
{
    /*
     * SP 800-38A: Appendix F: Example Vectors for Modes of Operation of the AES
     * PlainText:
     *  6bc1bee22e409f96e93d7e117393172a
     *  ae2d8a571e03ac9c9eb76fac45af8e51
     *  30c81c46a35ce411e5fbc1191a0a52ef
     *  f69f2445df4f9b17ad2b417be66c3710
     */
    uint8_t data[DATA_SIZE] =
    {
        0x6b, 0xc1, 0xbe, 0xe2, 0x2e, 0x40, 0x9f, 0x96, 0xe9, 0x3d, 0x7e, 0x11, 0x73, 0x93, 0x17, 0x2a,
        0xae, 0x2d, 0x8a, 0x57, 0x1e, 0x03, 0xac, 0x9c, 0x9e, 0xb7, 0x6f, 0xac, 0x45, 0xaf, 0x8e, 0x51,
        0x30, 0xc8, 0x1c, 0x46, 0xa3, 0x5c, 0xe4, 0x11, 0xe5, 0xfb, 0xc1, 0x19, 0x1a, 0x0a, 0x52, 0xef,
        0xf6, 0x9f, 0x24, 0x45, 0xdf, 0x4f, 0x9b, 0x17, 0xad, 0x2b, 0x41, 0x7b, 0xe6, 0x6c, 0x37, 0x10
    };

    /*
     * SP 800-38A: F.4.1 OFB-AES128.Encrypt
     * Key 2b7e151628aed2a6abf7158809cf4f3c
     *  IV 000102030405060708090a0b0c0d0e0f
     */
    uint8_t key[AES128_KEY_SIZE] =
    {
        0x2b, 0x7e, 0x15, 0x16, 0x28, 0xae, 0xd2, 0xa6, 0xab, 0xf7, 0x15, 0x88, 0x09, 0xcf, 0x4f, 0x3c
    };

    uint8_t iv[16] =
    {
        0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f
    };

    uint8_t enc[DATA_SIZE], dec[DATA_SIZE];

    printf("     input: \n");
    print_buffer(data, DATA_SIZE, "      ");

    memset(enc, 0, DATA_SIZE);
    AES_OFB_Encrypt(AES128, data, DATA_SIZE, key, iv, enc);
    printf("encryption: \n");
    print_buffer(enc, DATA_SIZE, "      ");

    memset(dec, 0, DATA_SIZE);
    AES_OFB_Decrypt(AES128, enc, DATA_SIZE, key, iv, dec);
    printf("decryption: \n");
    print_buffer(dec, DATA_SIZE, "      ");

    return 0;
}

static int test_AES192_OFB(void)
{
    uint8_t data[DATA_SIZE] =
    {
        0x6b, 0xc1, 0xbe, 0xe2, 0x2e, 0x40, 0x9f, 0x96, 0xe9, 0x3d, 0x7e, 0x11, 0x73, 0x93, 0x17, 0x2a,
        0xae, 0x2d, 0x8a, 0x57, 0x1e, 0x03, 0xac, 0x9c, 0x9e, 0xb7, 0x6f, 0xac, 0x45, 0xaf, 0x8e, 0x51,
        0x30, 0xc8, 0x1c, 0x46, 0xa3, 0x5c, 0xe4, 0x11, 0xe5, 0xfb, 0xc1, 0x19, 0x1a, 0x0a, 0x52, 0xef,
        0xf6, 0x9f, 0x24, 0x45, 0xdf, 0x4f, 0x9b, 0x17, 0xad, 0x2b, 0x41, 0x7b, 0xe6, 0x6c, 0x37, 0x10
    };

    /*
     * SP 800-38A: F.4.3 OFB-AES192.Encrypt
     * Key 8e73b0f7da0e6452c810f32b809079e562f8ead2522c6b7b
     *  IV 000102030405060708090a0b0c0d0e0f
     */
    uint8_t key[AES192_KEY_SIZE] =
    {
        0x8e, 0x73, 0xb0, 0xf7, 0xda, 0x0e, 0x64, 0x52, 0xc8, 0x10, 0xf3, 0x2b, 0x80, 0x90, 0x79, 0xe5,
        0x62, 0xf8, 0xea, 0xd2, 0x52, 0x2c, 0x6b, 0x7b
    };

    uint8_t iv[16] =
    {
        0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f
    };

    uint8_t enc[DATA_SIZE], dec[DATA_SIZE];

    printf("     input: \n");
    print_buffer(data, DATA_SIZE, "      ");

    memset(enc, 0, DATA_SIZE);
    AES_OFB_Encrypt(AES192, data, DATA_SIZE, key, iv, enc);
    printf("encryption: \n");
    print_buffer(enc, DATA_SIZE, "      ");

    memset(dec, 0, DATA_SIZE);
    AES_OFB_Decrypt(AES192, enc, DATA_SIZE, key, iv, dec);
    printf("decryption: \n");
    print_buffer(dec, DATA_SIZE, "      ");

    return 0;
}

static int test_AES256_OFB(void)
{
    uint8_t data[DATA_SIZE] =
    {
        0x6b, 0xc1, 0xbe, 0xe2, 0x2e, 0x40, 0x9f, 0x96, 0xe9, 0x3d, 0x7e, 0x11, 0x73, 0x93, 0x17, 0x2a,
        0xae, 0x2d, 0x8a, 0x57, 0x1e, 0x03, 0xac, 0x9c, 0x9e, 0xb7, 0x6f, 0xac, 0x45, 0xaf, 0x8e, 0x51,
        0x30, 0xc8, 0x1c, 0x46, 0xa3, 0x5c, 0xe4, 0x11, 0xe5, 0xfb, 0xc1, 0x19, 0x1a, 0x0a, 0x52, 0xef,
        0xf6, 0x9f, 0x24, 0x45, 0xdf, 0x4f, 0x9b, 0x17, 0xad, 0x2b, 0x41, 0x7b, 0xe6, 0x6c, 0x37, 0x10
    };

    /*
     * SP 800-38A: F.4.5 OFB-AES256.Encrypt
     * Key 603deb1015ca71be2b73aef0857d7781
     *     1f352c073b6108d72d9810a30914dff4
     *  IV 000102030405060708090a0b0c0d0e0f
     */
    uint8_t key[AES256_KEY_SIZE] =
    {
        0x60, 0x3d, 0xeb, 0x10, 0x15, 0xca, 0x71, 0xbe, 0x2b, 0x73, 0xae, 0xf0, 0x85, 0x7d, 0x77, 0x81,
        0x1f, 0x35, 0x2c, 0x07, 0x3b, 0x61, 0x08, 0xd7, 0x2d, 0x98, 0x10, 0xa3, 0x09, 0x14, 0xdf, 0xf4
    };

    uint8_t iv[16] =
    {
        0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f
    };

    uint8_t enc[DATA_SIZE], dec[DATA_SIZE];

    printf("     input: \n");
    print_buffer(data, DATA_SIZE, "      ");

    memset(enc, 0, DATA_SIZE);
    AES_OFB_Encrypt(AES256, data, DATA_SIZE, key, iv, enc);
    printf("encryption: \n");
    print_buffer(enc, DATA_SIZE, "      ");

    memset(dec, 0, DATA_SIZE);
    AES_OFB_Decrypt(AES256, enc, DATA_SIZE, key, iv, dec);
    printf("decryption: \n");
    print_buffer(dec, DATA_SIZE, "      ");

    return 0;
}

static void test_AES_OFB(void)
{
    printf("AES-128 OFB Encryption/Decryption Test:\n");
    test_AES128_OFB();
    printf("\n");

    printf("AES-192 OFB Encryption/Decryption Test:\n");
    test_AES192_OFB();
    printf("\n");

    printf("AES-256 OFB Encryption/Decryption Test:\n");
    test_AES256_OFB();
    printf("\n");
}